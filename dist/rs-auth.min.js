var app=angular.module("rs-auth",[]),app=angular.module("rs-auth");app.provider("$rsAuth",function(){var e={apiPrefix:""},t={visitor:"user-visitor",member:"user-member"};this.setConfig=function(t){t.apiPrefix&&(e.apiPrefix=t.apiPrefix)},this.setUserRoles=function(e){t=e},this.$get=function(r,n){return{login:function(t,s){return r({url:e.apiPrefix+t,method:"POST",data:s}).then(function(e){return s.remember&&n.setLocalAuth(e.data.token),n.set("authToken",e.data.token),n.set("userRole",e.data.user.status),n.setUser(e.data.user),e})},logout:function(t){return r({url:e.apiPrefix+t,method:"GET",headers:{"X-Auth-Token":n.get("authToken")}}).then(function(){n.clear()})},register:function(t,s){return r({url:e.apiPrefix+t,method:"POST",data:s}).then(function(e){return n.set("authToken",e.data.token),n.set("userRole","user"),n.setUser(e.data.user),e})},validateToken:function(t,s){return r({url:e.apiPrefix+t,method:"GET",headers:{"X-Auth-Token":s}}).then(function(e){return n.set("authToken",s),n.set("userRole","user"),n.setUser(e.data),e})},isAuthenticated:function(){return!!n.get("authToken")},isAuthorized:function(e){return angular.isArray(e)||(e=[e]),this.isAuthenticated()&&-1!==e.indexOf(n.get("userRole"))},userRoles:t}}});var app=angular.module("rs-auth");app.service("$rsSession",["$window",function(e){this.set=function(t,r){e.sessionStorage.setItem(t,r)},this.get=function(t){return e.sessionStorage.getItem(t)},this.setUser=function(t){e.sessionStorage.setItem("user",JSON.stringify(t))},this.getUser=function(){return JSON.parse(e.sessionStorage.getItem("user"))},this.unset=function(t){e.sessionStorage.removeItem(t)},this.remembered=function(){return!!e.sessionStorage.getItem("authToken")},this.setLocalAuth=function(t){e.localStorage.setItem("authToken",t)},this.getLocalAuth=function(){return e.localStorage.getItem("authToken")},this.clear=function(){e.sessionStorage.clear(),e.localStorage.clear()}}]);